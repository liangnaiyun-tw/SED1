# TL;DR
To use auto testing, follow the steps below.

## 0. Folder Structure
The structure of your folders should contain following directories.
```
[dir] [YourFolder]/**/
--> [dir] [CodeFolder]/
----->  *.java
--> [dir] [TestFolder]/
----->  sampleInput*.txt    # Test cases
----->  sampleOutput*.txt   # Expected results
----->  [TestScript.ps1]    # Test script for powershell
```

* `YourFolder`: The folder path for your implementation.
* `CodeFolder`: The folder of `java` files.
* `TestFolder`: The folder where you put your test cases.
* `TestScript.ps1`: The auto-testing script run by `Powershell`.

## 1. Change Maven Configuration
Change **[maven.yml](./.github/workflows/maven.yml)** with the following form.
```yml
on.push.branches:
- [YourBranch]
on.push.paths:
- '**/[path to CodeFolder]/**'
...
-name: Run the Maven
 run: |
   cd .\[path to TestFolder]
   .\[TestScript.ps1]
```
Where `YourBranch` is the branch to be merged.

## 2. Add Testing Script
In `.github` there is a powershell script template **[testTemplate.ps1](./.github/workflows/testTemplate.ps1)**, copy the script to `./[path to your TestFolder]`. In the script, change the first two lines.
```powershell
$codeFolder = "\[CodeFolder]"
$testFolder = "\[TestFolder]"
...
```

## 3. Use Github Command
Use `push` command as before.

## 4. Results
In commit list
![](https://i.imgur.com/QSeYC9m.png)

Green check means the commit pass the test, and red cross is not. The commit without above two means that the change in the commit does not trigger the testing process.

The branch can be merged into main branch unless the latest workflow pass the test.

> **Note**<br>
> For changes in `TestFolder`, the test event will not triggered.

# Auto Testing
## Maven Configuration
In **[.github/workflows](./.github/workflows)**, there is a Maven configuration file **[maven.yml](./.github/workflows/maven.yml)** used to run testing process. In the YAML file

* `on.push.branches`<br>
The workflow will trigger when the push commit contains a change in specified branches.
* `on.push.paths`<br>
The workflow will trigger when the push commit contains a change in specified paths.

* `jobs.build.runs-on` specifies which OS server is used to run the Maven configuration. The default is `windows-lastest`, which uses Windows Server 2022.

* `jobs.build.steps.with`
    - `java-version` The Java version. Default is `17`.
    - `distribution` The JDK distribution. Default is `temurin`.
    - `architecture` The target architecture of the package. Default is `x64`.

* `jobs.build.steps.run`<br>
The commands run on server by Maven. Since the current OS is Windows by `windows-latest`, the commands are run in `powershell` environment. The commands are showed below
```yml
...
- name: Run the Maven
  run: |
    cd .\[YourFolder]\[path to TestFolder]
    .\[TestScript.ps1]
```
* `YourFolder`: The folder you implemented.
* `TestFolder`: The folder where you put your test cases.
* `TestScript.ps1`: The testing script run by `Powershell`.

> **Note**<br>
> In powershell, the testing script uses `Compare-Object` command to compare expected output and result.

## Testing script run by Powershell
In `TestFolder`, there should be an powershell script file `TestScript.ps1` to run testing process, the content is like below
```powershell
$codeFolder = "\[CodeFolder]"
$testFolder = "\[TestFolder]"
...
```
Where `CodeFolder` is the directory of your java files (like `src`).

> **Note**
> There is a template powershell script **[testTemplate.ps1](./.github/workflows/testTemplate.ps1)**, you can use the template or make your own testing script.

## Test Result
After running `push` command, `maven.yml` should run the testing process, and generate `result*.txt` files in `TestFolder`, containing the outputs generated by compiled classes.

**Test results**

(1) In Github, select the `Action tab`
![](https://i.imgur.com/YmhhHSH.png)

(2) You will see the workflows for some commits
![](https://i.imgur.com/Ncf58I6.png)

(3) Click one of workflows
![](https://i.imgur.com/LVZHLqc.png)

(4) Click build on the jobs tab, the result of the test lies in `Run the Maven` tab
![](https://i.imgur.com/HCVwQEd.png)

(5) In commit list<br>
![](https://i.imgur.com/QSeYC9m.png)

(6) In `TestFolder`
![](https://i.imgur.com/GsjJtU3.png)

Green check means the commit pass the test, and red cross is not. The commit without above two means that the change in the commit does not trigger the testing process.

The branch can be merged into main branch unless the latest workflow pass the test.
## How Should Your Folder be Structured
The directory `YourFolder` should be structured like below to trigger testing process.
```
[dir] [YourFolder]/**/
--> [dir] [CodeFolder]/
----->  *.java
--> [dir] [TestFolder]/
----->  sampleInput*.txt    # Test cases
----->  sampleOutput*.txt   # Expected results
----->  [TestScript.ps1]    # Test script for powershell
```